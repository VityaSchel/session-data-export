import{c as Z,a,t as v,n as Kt,b as bt}from"../chunks/D_zFbOHK.js";import{p as Zt,m as C,j as qt,s as B,i,k as s,t as j,g as t,n as Q,a as Rt,o as at,q as Ct,v as Pt}from"../chunks/GWGwTHT7.js";import{i as d,s as M}from"../chunks/CUTSkJFb.js";import{s as nt,a as Wt,b as Tt,c as Dt,e as kt,i as Gt,d as Xt}from"../chunks/BXXofbHt.js";import{p as Yt}from"../chunks/D2gtD6uO.js";/**
 * filesize
 *
 * @copyright 2024 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 10.1.6
 */const $t="array",te="bit",Lt="bits",ee="byte",zt="bytes",rt="",ae="exponent",re="function",Ot="iec",ne="Invalid number",se="Invalid rounding method",jt="jedec",oe="object",Ut=".",ie="round",le="s",ve="si",ce="kbit",fe="kB",me=" ",de="string",ue="0",Mt={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function Ft(q,{bits:l=!1,pad:c=!1,base:f=-1,round:P=2,locale:A=rt,localeOptions:T={},separator:S=rt,spacer:E=me,symbols:G={},standard:p=rt,output:e=de,fullform:o=!1,fullforms:m=[],exponent:x=-1,roundingMethod:st=ie,precision:w=0}={}){let n=x,R=Number(q),r=[],D=0,W=rt;p===ve?(f=10,p=jt):p===Ot||p===jt?f=2:f===2?p=Ot:(f=10,p=jt);const X=f===10?1e3:1024,yt=o===!0,ot=R<0,mt=Math[st];if(typeof q!="bigint"&&isNaN(q))throw new TypeError(ne);if(typeof mt!==re)throw new TypeError(se);if(ot&&(R=-R),(n===-1||isNaN(n))&&(n=Math.floor(Math.log(R)/Math.log(X)),n<0&&(n=0)),n>8&&(w>0&&(w+=8-n),n=8),e===ae)return n;if(R===0)r[0]=0,W=r[1]=Mt.symbol[p][l?Lt:zt][n];else{D=R/(f===2?Math.pow(2,n*10):Math.pow(1e3,n)),l&&(D=D*8,D>=X&&n<8&&(D=D/X,n++));const z=Math.pow(10,n>0?P:0);r[0]=mt(D*z)/z,r[0]===X&&n<8&&x===-1&&(r[0]=1,n++),W=r[1]=f===10&&n===1?l?ce:fe:Mt.symbol[p][l?Lt:zt][n]}if(ot&&(r[0]=-r[0]),w>0&&(r[0]=r[0].toPrecision(w)),r[1]=G[r[1]]||r[1],A===!0?r[0]=r[0].toLocaleString():A.length>0?r[0]=r[0].toLocaleString(A,T):S.length>0&&(r[0]=r[0].toString().replace(Ut,S)),c&&P>0){const z=r[0].toString(),dt=S||(z.match(/(\D)/g)||[]).pop()||Ut,ut=z.toString().split(dt),ht=ut[1]||rt,pt=ht.length,wt=P-pt;r[0]=`${ut[0]}${dt}${ht.padEnd(pt+wt,ue)}`}return yt&&(r[1]=m[n]?m[n]:Mt.fullform[p][n]+(l?te:ee)+(r[0]===1?rt:le)),e===$t?r:e===oe?{value:r[0],symbol:r[1],exponent:n,unit:W}:r.join(E)}var he=v('<img alt="attachment" class="mt-1 mb-2 max-h-[500px] rounded-md bg-neutral-600 object-contain">'),pe=v('<a class="mt-1 mb-2 block border border-neutral-700 bg-neutral-900 px-3 py-2">Save <span class="font-medium underline"> </span> </a>'),ge=v('<div class="mt-1 mb-2 rounded-md bg-red-950 px-2 py-1">File not found locally: <span class="font-medium"> </span> </div>');function _e(q,l){Zt(l,!0);const c=Q(()=>`/data/conversations/${l.conversationId}/attachments/${l.attachment.src}`);var f=Z(),P=C(f);{var A=S=>{var E=Z(),G=C(E);{var p=o=>{var m=he();j(()=>nt(m,"src",t(c))),a(o,m)},e=o=>{var m=pe(),x=B(i(m)),st=i(x,!0);s(x);var w=B(x);s(m),j(n=>{nt(m,"href",t(c)),nt(m,"download",l.attachment.fileName),M(st,l.attachment.fileName),M(w,` (${n??""})`)},[()=>Ft(l.attachment.size)]),a(o,m)};d(G,o=>{l.attachment.contentType.startsWith("image/")?o(p):o(e,!1)})}a(S,E)},T=S=>{var E=ge(),G=B(i(E)),p=i(G,!0);s(G);var e=B(G);s(E),j(o=>{M(p,l.attachment.fileName),M(e,` (${o??""}, ${l.attachment.contentType??""})`)},[()=>Ft(l.attachment.size)]),a(S,E)};d(P,S=>{l.attachment.src?S(A):S(T,!1)})}a(q,f),qt()}var xe=v('<h1 class="absolute top-1/2 left-1/2 w-max -translate-1/2 text-2xl font-medium md:text-4xl lg:text-6xl">Chat not found</h1>'),be=v('<img alt="Avatar" class="mr-2 h-10 w-10 shrink-0 rounded-full text-[0px]">'),ye=v('<div class="mr-2 flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-neutral-500/20 text-sm text-neutral-500"><span> </span></div>'),we=Kt('<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 20 20"><path fill="currentColor" d="m5.83 9l5.58-5.58L10 2l-8 8l8 8l1.41-1.41L5.83 11H18V9z"></path></svg>'),Be=Kt('<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 20 20"><path fill="currentColor" d="M2 11h12.2l-5.6 5.6L10 18l8-8l-8-8l-1.4 1.4L14.2 9H2z"></path></svg>'),Se=v('<span class="p-3 opacity-50"><!></span>'),Ee=v('<a aria-label="Previous page"><!></a>'),Ie=v('<!> <span class="tabular-nums"> </span> <!>',1),Ne=v(`<p class="absolute top-1/2 left-1/2 max-w-[90%] -translate-1/2 text-center">Chat history for SOGS is not preserved for storage economy reasons. You can work with SQL
          database directly to restore any saved messages from SOGS.</p>`),Te=v('<h4 class="absolute top-1/2 left-1/2 -translate-1/2 text-center">Messages not found</h4>'),De=v('<div class="flex items-center justify-center"><div class="rounded-xl bg-neutral-800 px-12 py-2 text-white"><span class="font-medium"><!></span> <!></div></div>'),ke=v('<div class="flex items-center justify-center"><div class="rounded-xl bg-neutral-800 px-12 py-2 text-white">Chat request accepted</div></div>'),je=v("<div><!> <span> </span> </div>"),Me=v('<div class="flex flex-col gap-2"><div class="sticky top-19 z-[1] flex w-full justify-center text-white"><span class="rounded-full bg-gray-500/30 px-2 py-0.5 text-sm font-medium backdrop-blur-lg"> </span></div> <!></div>'),Ae=v('<div class="flex flex-col gap-2 p-3"></div>'),Re=v('<header class="sticky top-0 z-[2] flex h-16 w-full items-center justify-between border-x-0 border-t-0 border-b border-neutral-500/20 bg-[#121212] px-4"><div class="flex items-center gap-1"><!> <h1 class="text-lg font-medium"> </h1></div> <div class="flex items-center gap-2"><!></div></header> <!>',1),Ce=v('<main class="relative h-screen flex-1 overflow-auto"><!></main>');function Oe(q,l){Zt(l,!0);let c=Ct(void 0),f=Q(()=>Yt.params.conversationId);Rt(()=>{at(c,void 0),fetch(`/data/conversations/${t(f)}/conversation.json`).then(e=>e.json()).then(e=>{at(c,e,!0)}).catch(e=>{at(c,null),console.error("Error fetching conversation:",e)})});const P=Q(()=>{var e;return((e=t(c))==null?void 0:e.messagesFiles)??1});let A=Q(()=>{const e=Yt.url.searchParams.get("page");if(e===null)return 1;const o=Number(e);return o<=0||!Number.isSafeInteger(o)?1:Math.min(o,t(P))}),T=Ct(null);Rt(()=>{at(T,null),t(c)&&fetch(`/data/conversations/${t(f)}/messages_${t(A)}.json`).then(e=>e.json()).then(e=>{at(T,e,!0)}).catch(e=>{at(T,[],!0),console.error("Error fetching messages:",e)})});const S=Q(()=>{if(!t(T))return[];let e=null,o=[],m=[];for(const x of t(T))e===null||Xt(e,new Date(x.sentAt))?(o.push(x),e===null&&(e=new Date(x.sentAt))):(e=new Date(x.sentAt),m.push(o),o=[x]);return m.push(o),m});var E=Ce(),G=i(E);{var p=e=>{var o=Z(),m=C(o);{var x=w=>{var n=xe();a(w,n)},st=w=>{var n=Re();const R=Q(()=>t(c).title||Wt(t(f)));var r=C(n),D=i(r),W=i(D);{var X=u=>{var h=be();j(()=>nt(h,"src",`/data/conversations/${t(f)??""}/avatar.png`)),a(u,h)},yt=u=>{var h=ye(),Y=i(h),I=i(Y);s(Y),s(h),j((k,V)=>M(I,`${k??""}${V??""}`),[()=>t(R).charAt(0).toUpperCase(),()=>t(R).charAt(1).toUpperCase()]),a(u,h)};d(W,u=>{t(c).avatar?u(X):u(yt,!1)})}var ot=B(W,2),mt=i(ot,!0);s(ot),s(D);var z=B(D,2);{const u=(h,Y=Pt,I=Pt)=>{var k=Z();const V=Q(()=>I()<=0||I()>t(P)),$=N=>{var g=Z(),L=C(g);{var it=U=>{var lt=we();a(U,lt)},gt=U=>{var lt=Be();a(U,lt)};d(L,U=>{Y()==="left"?U(it):U(gt,!1)})}a(N,g)};var Bt=C(k);{var O=N=>{var g=Se(),L=i(g);$(L),s(g),a(N,g)},H=N=>{var g=Ee();Tt(g,1,Dt(["p-3"]));var L=i(g);$(L),s(g),j(()=>nt(g,"href",`?page=${I()??""}`)),a(N,g)};d(Bt,N=>{t(V)?N(O):N(H,!1)})}a(h,k)};var dt=i(z);{var ut=h=>{var Y=Ie(),I=C(Y);u(I,()=>"left",()=>t(A)-1);var k=B(I,2),V=i(k);s(k);var $=B(k,2);u($,()=>"right",()=>t(A)+1),j(()=>M(V,`Page ${t(A)??""}/${t(c).messagesFiles??""}`)),a(h,Y)};d(dt,h=>{t(P)>0&&h(ut)})}s(z)}s(r);var ht=B(r,2);{var pt=u=>{var h=Ne();a(u,h)},wt=(u,h)=>{{var Y=I=>{var k=Z(),V=C(k);{var $=O=>{var H=Te();a(O,H)},Bt=O=>{var H=Ae();kt(H,21,()=>t(S),N=>N[0].id,(N,g)=>{var L=Me(),it=i(L),gt=i(it),U=i(gt,!0);s(gt),s(it);var lt=B(it,2);kt(lt,17,()=>t(g),Gt,(St,b)=>{var At=Z(),Vt=C(At);{var Ht=tt=>{var vt=De(),_t=i(vt),ct=i(_t),F=i(ct);{var K=_=>{var y=bt();j(()=>M(y,t(c).title)),a(_,y)},xt=_=>{var y=bt("You");a(_,y)};d(F,_=>{t(b).dataExtractionNotification.source===t(f)?_(K):_(xt,!1)})}s(ct);var Et=B(ct,2);{var J=_=>{var y=bt("took a screenshot");a(_,y)},It=(_,y)=>{{var et=ft=>{var Nt=bt("saved media");a(ft,Nt)};d(_,ft=>{t(b).dataExtractionNotification.type===2&&ft(et)},y)}};d(Et,_=>{t(b).dataExtractionNotification.type===1?_(J):_(It,!1)})}s(_t),s(vt),a(tt,vt)},Jt=(tt,vt)=>{{var _t=F=>{var K=ke();a(F,K)},ct=F=>{var K=je(),xt=i(K);{var Et=y=>{var et=Z(),ft=C(et);kt(ft,17,()=>t(b).attachments,Gt,(Nt,Qt)=>{_e(Nt,{get attachment(){return t(Qt)},get conversationId(){return t(f)}})}),a(y,et)};d(xt,y=>{t(b).attachments&&y(Et)})}var J=B(xt,2),It=i(J,!0);s(J);var _=B(J);s(K),j((y,et)=>{Tt(K,1,Dt(["relative w-fit max-w-[90%] rounded-xl px-3 py-2 break-words",{"bg-neutral-800 text-white":t(b).type==="incoming","bg-session ml-auto text-black":t(b).type==="outgoing"}])),Tt(J,1,Dt(["absolute bottom-0 mb-1 w-max text-xs text-neutral-600",{"left-full ml-2":t(b).type==="incoming","right-full mr-2":t(b).type==="outgoing"}])),nt(J,"title",y),M(It,et),M(_,` ${t(b).body??""}`)},[()=>new Intl.DateTimeFormat("en-US",{timeStyle:"long"}).format(new Date(t(b).sentAt)),()=>new Intl.DateTimeFormat("en-US",{timeStyle:"short"}).format(new Date(t(b).sentAt))]),a(F,K)};d(tt,F=>{"messageRequestResponse"in t(b)?F(_t):F(ct,!1)},vt)}};d(Vt,tt=>{t(b).dataExtractionNotification?tt(Ht):tt(Jt,!1)})}a(St,At)}),s(L),j(St=>M(U,St),[()=>new Date(t(g)[0].sentAt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]),a(N,L)}),s(H),a(O,H)};d(V,O=>{t(T).length==0?O($):O(Bt,!1)})}a(I,k)};d(u,I=>{t(T)&&I(Y)},h)}};d(ht,u=>{t(c).sog?u(pt):u(wt,!1)})}j(()=>M(mt,t(R))),a(w,n)};d(m,w=>{t(c)===null?w(x):w(st,!1)})}a(e,o)};d(G,e=>{t(c)!==void 0&&e(p)})}s(E),a(q,E),qt()}export{Oe as component};
